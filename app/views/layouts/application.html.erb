<!DOCTYPE html>
<html>
<head>
  <title>WeatherApp</title>
  <%= stylesheet_link_tag    "application", :media => "all" %>
  <%= javascript_include_tag "application" %>
  <%= csrf_meta_tags %>
</head>
<body class="">

  <header>
    <section class="header-content">
      <a href="<%= root_url %>">
        <h1 class="site-logo">Partly Sunny</h1>
      <a>

      <nav>

        <form action="<%= search_zip_codes_url %>" method="get" class="input">

          <%= insert_form_authenticity_token %>

          <input
            type="search"
            name="search_query"
            value=""
            id="search_query"
            placeholder="Search & Favorites">

          <input class="submit" type="submit" value="Search">
        </form>

        <!-- <input
          type="search"
          name="site_search"
          value=""
          id="site_search"
          placeholder="Search & Favorites"> -->
        <ul>
          <li class="icon show-modal" id="new-post">
            Post a New Weather Report or Photo
            <div class="nav-bar-dropdown hidden">
              <div class="triangle-up">&nbsp;</div>
              <%= render "nav_bar_dropdowns/post_button_explanation", current_user: current_user %>
            </div>
          </li>
          <li class="icon" id="notifications">
            <div class="relative-dummy-element">
              Notifications
              <div class="nav-bar-dropdown hidden">
                <div class="triangle-up">&nbsp;</div>
                <%= render "nav_bar_dropdowns/notifications", current_user: current_user %>
              </div>
            </div>
          </li>
          <li class="icon" id="user-menu">
            User Menu
            <div class="nav-bar-dropdown hidden">
              <div class="triangle-up">&nbsp;</div>
              <%= render "nav_bar_dropdowns/user_menu", current_user: current_user %>
            </div>
          </li>
          <li class="icon" id="settings-menu">
            Settings Menu
            <div class="nav-bar-dropdown hidden">
              <div class="triangle-up">&nbsp;</div>
              <%= render "nav_bar_dropdowns/settings_menu", current_user: current_user %>
            </div>
          </li>
        </ul>
      </nav>
    </section>
  </header>

  <div class="content group">

  <!-- The body should consist of two columns: -->
    <!-- left-column & main-column OR -->
    <!-- zip_code-weather-left-column & zip_code-weather-right-column -->

    <%= yield %>

  </div>

  <footer>

  </footer>

  <section class="modal">
    <section class="modal-box">
      <span class="modal-close-button">&times;</span>

      <div id="modal-container">
        <%= render "weather_reports/new_with_photo",
          weather_conditions: @weather_conditions,
          photo: @new_photo %>
      </div>
    </section>
  </section>

<!-- <p>params: <%= params %></p>
<p>session: <%= session %></p> -->

<%= "<p>errors: #{flash[:errors]} </p>".html_safe if flash[:errors] %>
<%= "<p>notice: #{flash[:notice]} </p>".html_safe if flash[:notice] %>

<%#= render "layouts/navigation_bar_signed_in" if signed_in? %>
<%#= render "layouts/navigation_bar_not_signed_in" if !signed_in? %>

<script>

$(document).ready(function() {

  window.modal = {
    show: function(){
      $("body").addClass("has-active-modal");
    },
    hide: function(){
      $("body").removeClass("has-active-modal");
    }
  };

  $("body").on("click", ".show-modal", function(event){
    event.preventDefault();
    window.modal.show();
  });

  $(".modal").on("click", function(event){

    $target = $(event.target);
    if($target.is(".modal") || $target.is(".modal-close-button")){
      event.preventDefault();
      window.modal.hide();
    }
  });
});

</script>

</body>
</html>
